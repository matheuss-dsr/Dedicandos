<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Gerar Prova ENEM</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f9f9f9; }
    h1, h2 { color: #333; }
    .error { color: red; margin-bottom: 15px; }
    form { background: #fff; padding: 20px; border-radius: 12px; margin-bottom: 30px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
    form label { display: block; margin-bottom: 8px; font-weight: bold; }
    form input, form select { width: 100%; padding: 8px; margin-bottom: 15px; border: 1px solid #ccc; border-radius: 8px; }
    form button { background: #4CAF50; color: #fff; border: none; padding: 10px 15px; border-radius: 8px; cursor: pointer; font-size: 1em; }
    form button:hover { background: #45a049; }
    .questao { background: #fff; border-radius: 12px; padding: 15px; margin-bottom: 20px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
    .questao h3 { margin: 0 0 10px; font-size: 1.1em; }
    .alternativas { margin-left: 20px; }
    .alternativa { margin: 5px 0; }
    .gabarito { font-weight: bold; color: green; margin-top: 10px; }
    .section { margin-bottom: 40px; }
  </style>
</head>
<body>
  <h1>Gerar Prova ENEM</h1>

  <% if (error) { %>
    <p class="error"><%= error %></p>
  <% } %>

  <form method="POST" action="/prova/gerar">
    <label for="year">Ano da Prova</label>
    <select id="year" name="year" required>
      <option value="2023">2023</option>
      <option value="2022">2022</option>
      <option value="2021">2021</option>
      <option value="2020">2020</option>
      <option value="2019">2019</option>
      <option value="2018">2018</option>
      <option value="2017">2017</option>
      <option value="2016">2016</option>
      <option value="2015">2015</option>
      <option value="2014">2014</option>
      <option value="2013">2013</option>
      <option value="2012">2012</option>
      <option value="2011">2011</option>
      <option value="2010">2010</option>
      <option value="2009">2009</option>
    </select>

    <label for="discipline">Disciplina</label>
    <select id="discipline" name="discipline" required>
      <option value="linguagens">Linguagens, CÃ³digos e suas Tecnologias</option>
      <option value="ciencias-humanas">CiÃªncias Humanas e suas Tecnologias</option>
      <option value="ciencias-natureza">CiÃªncias da Natureza e suas Tecnologias</option>
      <option value="matematica">MatemÃ¡tica e suas Tecnologias</option>
    </select>

    <label for="quantity">Quantidade de QuestÃµes</label>
    <input type="number" id="quantity" name="quantity" min="1" max="45" required>

    <button type="submit">Gerar Prova</button>
  </form>

  <!-- QuestÃµes Originais do ENEM -->
  <div class="section">
    <h2>ðŸ“˜ QuestÃµes Originais do ENEM</h2>
    <% if (questoesOriginais && questoesOriginais.length > 0) { %>
      <% questoesOriginais.forEach((q, idx) => { %>
        <div class="questao">
          <h3><%= idx + 1 %>. <%= q.title %></h3>
          <p><strong>Disciplina:</strong> <%= q.discipline %> | <strong>Idioma:</strong> <%= q.language %></p>
          <div class="alternativas">
            <% if (q.alternatives && q.alternatives.length > 0) { %>
              <% q.alternatives.forEach((alt, aIdx) => { %>
                <div class="alternativa"><strong><%= String.fromCharCode(65 + aIdx) %>)</strong> <%= alt %></div>
              <% }) %>
            <% } else { %>
              <div class="alternativa">Sem alternativas disponÃ­veis.</div>
            <% } %>
          </div>
          <p class="gabarito">âœ… Resposta correta: <%= q.correctAlternative %></p>
        </div>
      <% }) %>
    <% } else { %>
      <p>Nenhuma questÃ£o do ENEM encontrada.</p>
    <% } %>
  </div>

  <!-- QuestÃµes Geradas pela IA -->
  <div class="section">
    <h2>ðŸ¤– QuestÃµes Geradas pela IA</h2>
    <% if (questoesIA && questoesIA.length > 0) { %>
      <% questoesIA.forEach((q, idx) => { %>
        <div class="questao">
          <h3><%= idx + 1 %>. <%= q.enunciado %></h3>
          <div class="alternativas">
            <% if (q.alternativas && q.alternativas.length > 0) { %>
              <% q.alternativas.forEach((alt, aIdx) => { %>
                <div class="alternativa"><strong><%= String.fromCharCode(65 + aIdx) %>)</strong> <%= alt %></div>
              <% }) %>
            <% } else { %>
              <div class="alternativa">Sem alternativas disponÃ­veis.</div>
            <% } %>
          </div>
          <p class="gabarito">âœ… Resposta correta: <%= q.gabarito %></p>
        </div>
      <% }) %>
    <% } else { %>
      <p>Nenhuma questÃ£o gerada pela IA.</p>
    <% } %>
  </div>
  <script src="https://unpkg.com/i18next@21.9.1/i18next.min.js"></script>
    <script>
      i18next.init({
        lng: 'pt',
        resources: {
          pt: {
            translation: { "QuestÃ£o": "QuestÃ£o", "Resultado": "Resultado" }
          },
          en: {
            translation: { "QuestÃ£o": "Question", "Resultado": "Result" }
          }
        }
      }, function(err, t) {
        document.querySelectorAll('.traduzir').forEach(el => {
          el.innerText = i18next.t(el.dataset.key);
        });
      });
    </script>

</body>
</html>
